gpu_list:
- 6
seed: null
dump_path: ./outputs/
data:
  split_path: /fast_scratch/WatChMaL/data/IWCD_fulltank_300_segmentation_idx.npz
  dataset:
    true_hits_h5file: /fast_scratch/WatChMaL/data/IWCD_mPMT_Short_pi0_E0to1000MeV_truehits.h5
    digi_truth_mapping_file: /fast_scratch/WatChMaL/data/IWCD_mPMT_Short_pi0_E0to1000MeV_truth_for_data.pkl
    _target_: watchmal.dataset.cnn_mpmt.cnn_mpmt_segmentation_dataset.CNNmPMTSegmentationDataset
    digi_dataset_config:
      _target_: watchmal.dataset.cnn_mpmt.cnn_mpmt_dataset.CNNmPMTDataset
      mpmt_positions_file: /data/WatChMaL/data/IWCDshort_mPMT_image_positions.npz
      h5file: /fast_scratch/WatChMaL/data/IWCD_mPMT_Short_pi0_E0to1000MeV_digihits.h5
      collapse_arrays: false
      is_distributed: false
model:
  _target_: watchmal.model.frrn.frrn
  n_classes: 4
engine:
  _target_: watchmal.engine.engine_segmentation.ClassifierEngine
tasks:
  train:
    epochs: 20
    report_interval: 10
    val_interval: 10
    num_val_batches: 32
    checkpointing: false
    data_loaders:
      train:
        split_key: train_idxs
        batch_size: 64
        num_workers: 4
        transforms:
        - horizontal_flip
        - vertical_flip
        sampler:
          _target_: torch.utils.data.sampler.SubsetRandomSampler
      validation:
        split_key: val_idxs
        batch_size: 64
        num_workers: 4
        sampler:
          _target_: watchmal.dataset.samplers.SubsetSequentialSampler
    optimizers:
      _target_: torch.optim.Adam
      lr: 0.001
      weight_decay: 0
  restore_best_state:
    placeholder: configs can't be empty
  evaluate:
    data_loaders:
      test:
        split_key: test_idxs
        batch_size: 512
        num_workers: 4
        sampler:
          _target_: watchmal.dataset.samplers.SubsetSequentialSampler
